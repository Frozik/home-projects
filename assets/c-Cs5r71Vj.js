import{a5 as F,a8 as pe,bS as q,a6 as ge,bT as ye,ae as de,ab as _,bK as J,bH as S,bU as w,aj as Q,bI as be,ac as ve,i as z,y as X,G as x,bz as C,bA as N,F as T,H as me,J as Z,bL as Te,W as j}from"./e-CjUCb2H_.js";import{b as ze,k as ee,c as re,s as he,a as we,d as Ae,U as L,S as xe,g as je}from"./c-Bm7ieymV.js";import{d as G,c as Fe}from"./c-BBJND8LZ.js";var B=Object.create,Se=function(){function e(){}return function(r){if(!F(r))return{};if(B)return B(r);e.prototype=r;var n=new e;return e.prototype=void 0,n}}();function Oe(e,r){for(var n=-1,t=e==null?0:e.length;++n<t&&r(e[n],n,e)!==!1;);return e}function ne(e,r,n){r=="__proto__"&&G?G(e,r,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[r]=n}var Pe=Object.prototype,$e=Pe.hasOwnProperty;function te(e,r,n){var t=e[r];(!($e.call(e,r)&&pe(t,n))||n===void 0&&!(r in e))&&ne(e,r,n)}function A(e,r,n,t){var l=!n;n||(n={});for(var s=-1,a=r.length;++s<a;){var o=r[s],c=void 0;c===void 0&&(c=e[o]),l?ne(n,o,c):te(n,o,c)}return n}function Ie(e){var r=[];if(e!=null)for(var n in Object(e))r.push(n);return r}var Ee=Object.prototype,Me=Ee.hasOwnProperty;function Ue(e){if(!F(e))return Ie(e);var r=q(e),n=[];for(var t in e)t=="constructor"&&(r||!Me.call(e,t))||n.push(t);return n}function O(e){return ge(e)?ze(e,!0):Ue(e)}var oe=ye(Object.getPrototypeOf,Object);function _e(e,r){return e&&A(r,ee(r),e)}function Ce(e,r){return e&&A(r,O(r),e)}var se=typeof exports=="object"&&exports&&!exports.nodeType&&exports,D=se&&typeof module=="object"&&module&&!module.nodeType&&module,Ne=D&&D.exports===se,R=Ne?de.Buffer:void 0,K=R?R.allocUnsafe:void 0;function Le(e,r){if(r)return e.slice();var n=e.length,t=K?K(n):new e.constructor(n);return e.copy(t),t}function Ge(e,r){return A(e,re(e),r)}var Be=Object.getOwnPropertySymbols,ae=Be?function(e){for(var r=[];e;)we(r,re(e)),e=oe(e);return r}:he;function De(e,r){return A(e,ae(e),r)}function Re(e){return Ae(e,O,ae)}var Ke=Object.prototype,We=Ke.hasOwnProperty;function He(e){var r=e.length,n=new e.constructor(r);return r&&typeof e[0]=="string"&&We.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function P(e){var r=new e.constructor(e.byteLength);return new L(r).set(new L(e)),r}function ke(e,r){var n=r?P(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var Ve=/\w*$/;function Ye(e){var r=new e.constructor(e.source,Ve.exec(e));return r.lastIndex=e.lastIndex,r}var W=_?_.prototype:void 0,H=W?W.valueOf:void 0;function qe(e){return H?Object(H.call(e)):{}}function Je(e,r){var n=r?P(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var Qe="[object Boolean]",Xe="[object Date]",Ze="[object Map]",er="[object Number]",rr="[object RegExp]",nr="[object Set]",tr="[object String]",or="[object Symbol]",sr="[object ArrayBuffer]",ar="[object DataView]",cr="[object Float32Array]",lr="[object Float64Array]",ir="[object Int8Array]",ur="[object Int16Array]",fr="[object Int32Array]",pr="[object Uint8Array]",gr="[object Uint8ClampedArray]",yr="[object Uint16Array]",dr="[object Uint32Array]";function br(e,r,n){var t=e.constructor;switch(r){case sr:return P(e);case Qe:case Xe:return new t(+e);case ar:return ke(e,n);case cr:case lr:case ir:case ur:case fr:case pr:case gr:case yr:case dr:return Je(e,n);case Ze:return new t;case er:case tr:return new t(e);case rr:return Ye(e);case nr:return new t;case or:return qe(e)}}function vr(e){return typeof e.constructor=="function"&&!q(e)?Se(oe(e)):{}}var mr="[object Map]";function Tr(e){return J(e)&&S(e)==mr}var k=w&&w.isMap,zr=k?Q(k):Tr,hr="[object Set]";function wr(e){return J(e)&&S(e)==hr}var V=w&&w.isSet,Ar=V?Q(V):wr,xr=1,jr=2,Fr=4,ce="[object Arguments]",Sr="[object Array]",Or="[object Boolean]",Pr="[object Date]",$r="[object Error]",le="[object Function]",Ir="[object GeneratorFunction]",Er="[object Map]",Mr="[object Number]",ie="[object Object]",Ur="[object RegExp]",_r="[object Set]",Cr="[object String]",Nr="[object Symbol]",Lr="[object WeakMap]",Gr="[object ArrayBuffer]",Br="[object DataView]",Dr="[object Float32Array]",Rr="[object Float64Array]",Kr="[object Int8Array]",Wr="[object Int16Array]",Hr="[object Int32Array]",kr="[object Uint8Array]",Vr="[object Uint8ClampedArray]",Yr="[object Uint16Array]",qr="[object Uint32Array]",i={};i[ce]=i[Sr]=i[Gr]=i[Br]=i[Or]=i[Pr]=i[Dr]=i[Rr]=i[Kr]=i[Wr]=i[Hr]=i[Er]=i[Mr]=i[ie]=i[Ur]=i[_r]=i[Cr]=i[Nr]=i[kr]=i[Vr]=i[Yr]=i[qr]=!0;i[$r]=i[le]=i[Lr]=!1;function h(e,r,n,t,l,s){var a,o=r&xr,c=r&jr,u=r&Fr;if(a!==void 0)return a;if(!F(e))return e;var y=ve(e);if(y){if(a=He(e),!o)return Fe(e,a)}else{var d=S(e),E=d==le||d==Ir;if(be(e))return Le(e,o);if(d==ie||d==ce||E&&!l){if(a=c||E?{}:vr(e),!o)return c?De(e,Ce(a,e)):Ge(e,_e(a,e))}else{if(!i[d])return l?e:{};a=br(e,d,o)}}s||(s=new xe);var M=s.get(e);if(M)return M;s.set(e,a),Ar(e)?e.forEach(function(b){a.add(h(b,r,n,b,e,s))}):zr(e)&&e.forEach(function(b,v){a.set(v,h(b,r,n,v,e,s))});var fe=u?c?Re:je:c?O:ee,U=y?void 0:fe(e);return Oe(U||e,function(b,v){U&&(v=b,b=e[v]),te(a,v,h(b,r,n,v,e,s))}),a}var Jr=1,Qr=4;function Y(e){return h(e,Jr|Qr)}var f=(e=>(e.Fixed="fixed",e.Guess="guess",e))(f||{}),p=(e=>(e.Unknown="unknown",e.Wrong="wrong",e))(p||{}),m=(e=>(e.None="none",e.Pen="pen",e.Notes="notes",e))(m||{});function Xr(e){const r=Math.round(Math.pow(e.length,.25));if(r<3)return x(C(N.OUT_OF_RANGE,{message:"Field size is not supported",description:`Field size is empty or less then 9x9, current size: ${r}x${r}`}));if(r**4!==e.length)return x(C(N.OUT_OF_RANGE,{message:"Field size is invalid",description:`Field cell count must be a perfect square, current cells count: ${e.length}`}));try{const n=Array.from(e).map(l=>{const s=parseInt(l.replace(/[.\-*]/g,"0"),Math.max(10,r));return s===0?{type:f.Guess,value:void 0,notes:[],status:p.Unknown}:{type:f.Fixed,value:s,notes:[],status:p.Unknown}}),t=ue({size:r,cells:n});for(let l=0;l<t.size**2;l++)for(let s=0;s<t.size**2;s++){const a=g(l,s,t.size),o=t.cells[a];o.status===p.Wrong&&o.type===f.Fixed&&(o.type=f.Guess)}return T(t)}catch(n){return x(me(n))}}function zn(e){const r=[];for(let n=0;n<e;n++)for(let t=0;t<e;t++)r.push([n,t]);return r}function Zr(e,r,n,t){if(r.type===m.None)return e;const l=g(n,t,e.size),s=e.cells[l];if(s.type===f.Fixed)return e;const a=[...e.cells],o={...s};return r.type===m.Pen?o.value!==r.value?(o.value=r.value,$(e,n,t).forEach(({row:c,column:u,cell:y})=>{a[g(c,u,e.size)]={...y,notes:y.notes.filter(d=>d!==r.value)}})):o.value=void 0:r.type===m.Notes&&(o.value=void 0,o.notes.includes(r.value)?o.notes=o.notes.filter(c=>c!==r.value):o.notes.push(r.value)),a[l]=o,ue({...e,cells:a})}function g(e,r,n){return e*n**2+r}function $(e,r,n,t=["row","column","group"]){const l=new Map,s=Math.floor(r/e.size)*e.size,a=Math.floor(n/e.size)*e.size;for(let o=0;o<e.size**2;o++){if(t.includes("row")){const c=g(r,o,e.size);l.set(c,{row:r,column:o,cell:e.cells[c]})}if(t.includes("column")){const c=g(o,n,e.size);l.set(c,{row:o,column:n,cell:e.cells[c]})}if(t.includes("group")){const c=Math.floor(o/e.size),u=o%e.size,y=g(s+c,a+u,e.size);l.set(y,{row:s+c,column:a+u,cell:e.cells[y]})}}return Array.from(l.values())}function ue(e){const r=[...e.cells];for(let n=0;n<e.size**2;n++)for(let t=0;t<e.size**2;t++){const l=g(n,t,e.size),s=e.cells[l],a=!z(s.value)&&$(e,n,t).some(({row:o,column:c,cell:{value:u}})=>(o!==n||c!==t)&&u===s.value);r[l]={...s,status:a?p.Wrong:p.Unknown}}return{...e,cells:r}}function hn(e){const r=new Map;for(let n=0;n<e.size;n++)for(let t=0;t<e.size;t++){const l=new Set;for(let s=0;s<e.size;s++)for(let a=0;a<e.size;a++){const o=g(n*e.size+s,t*e.size+a,e.size),c=e.cells[o];z(c.value)||l.add(c.value)}l.forEach(s=>r.set(s,(r.get(s)??0)+1))}return r}function en(e){return Array(e).fill(0).map((r,n)=>n)}function rn(e){const r=[...e.cells];for(let n=0;n<e.size**2;n++)for(let t=0;t<e.size**2;t++){const l=g(n,t,e.size),s=e.cells[l],a=new Set($(e,n,t).filter(({row:o,column:c,cell:{value:u}})=>(o!==n||c!==t)&&!z(u)).map(({cell:{value:o}})=>o));r[l]={...s,notes:en(e.size**2).map(o=>o+1).filter(o=>!a.has(o))}}return{...e,cells:r}}function wn(e){for(let r=0;r<e.size**4;r++){const n=e.cells[r];if(n.status===p.Wrong||z(n.value))return!1}return!0}function nn(e){const r=[...e.cells];for(let n=0;n<e.size**4;n++){const t=e.cells[n];t.type===f.Fixed?r[n]={...t,status:p.Unknown}:r[n]={...t,notes:[],value:void 0,status:p.Unknown}}return{...e,cells:r}}function tn(e){for(let r=0;r<e.size**4;r++){const n=e.cells[r];if(n.type!==f.Fixed&&!X(n.notes))return!0}return!1}function on(e){const r=[...e.cells];for(let n=0;n<e.size**4;n++){const t=e.cells[n];t.type===f.Fixed||X(t.notes)||(r[n]={...t,notes:[]})}return{...e,cells:r}}const sn={field:Z,tool:{type:m.None,value:void 0},history:[]},I=Te({name:"sudoku",initialState:sn,reducers:e=>({resetPuzzle:e.reducer(r=>{r.field=Z,r.history=[]}),restartPuzzle:e.reducer(r=>{j(r.field)&&(r.field=T(nn(r.field.value)),r.history=[])}),loadPuzzle:e.reducer((r,{payload:n})=>{r.field=Xr(n),r.history=[]}),setTool:e.reducer((r,{payload:n})=>{if(!z(r.tool.value)&&r.tool.value===n.value&&r.tool.type===n.type){r.tool={type:m.None,value:void 0};return}r.tool=n}),applyTool:e.reducer((r,{payload:{row:n,column:t}})=>{!j(r.field)||r.field.value.size===0||r.tool.type===m.None||(r.history=[...r.history,Y(r.field.value)],r.field=T(Zr(r.field.value,r.tool,n,t)))}),markField:e.reducer(r=>{!j(r.field)||r.field.value.size===0||(r.history=[...r.history,Y(r.field.value)],tn(r.field.value)?r.field=T(on(r.field.value)):r.field=T(rn(r.field.value)))}),restorePreviousState:e.reducer(r=>{const n=r.history.pop();z(n)||(r.field=T(n))})}),selectors:{selectField:({field:e})=>e,selectTool:({tool:e})=>e,selectHasHistory:({history:e})=>e.length>0}}),{resetPuzzle:an,restartPuzzle:cn,loadPuzzle:ln,setTool:un,applyTool:fn,markField:pn,restorePreviousState:gn}=I.actions,{selectField:yn,selectTool:dn,selectHasHistory:bn}=I.selectors,An=Object.freeze(Object.defineProperty({__proto__:null,applyTool:fn,loadPuzzle:ln,markField:pn,resetPuzzle:an,restartPuzzle:cn,restorePreviousState:gn,selectField:yn,selectHasHistory:bn,selectTool:dn,setTool:un,sudokuSlice:I},Symbol.toStringTag,{value:"Module"}));export{m as E,en as a,zn as b,f as c,p as d,dn as e,bn as f,hn as g,tn as h,fn as i,un as j,gn as k,ln as l,pn as m,cn as n,An as o,wn as p,an as r,yn as s};
