import{ah as F,ak as pe,bU as q,ai as ge,bV as de,aq as ye,an as _,bM as J,bJ as O,bW as w,av as X,bK as be,ao as ve,i as h,N as Z,X as x,bB as C,bC as N,W as T,Y as me,Z as Q,bO as Te,a7 as j}from"./e-B1WDbROy.js";import{b as he,k as ee,c as re,s as ze,a as we,d as Ae,U as L,S as xe,g as je}from"./c-La584Cza.js";import{d as G,c as Fe}from"./c-B7w-baJC.js";var B=Object.create,Oe=function(){function e(){}return function(r){if(!F(r))return{};if(B)return B(r);e.prototype=r;var n=new e;return e.prototype=void 0,n}}();function Se(e,r){for(var n=-1,t=e==null?0:e.length;++n<t&&r(e[n],n,e)!==!1;);return e}function ne(e,r,n){r=="__proto__"&&G?G(e,r,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[r]=n}var Pe=Object.prototype,$e=Pe.hasOwnProperty;function te(e,r,n){var t=e[r];(!($e.call(e,r)&&pe(t,n))||n===void 0&&!(r in e))&&ne(e,r,n)}function A(e,r,n,t){var i=!n;n||(n={});for(var s=-1,a=r.length;++s<a;){var o=r[s],l=void 0;l===void 0&&(l=e[o]),i?ne(n,o,l):te(n,o,l)}return n}function Ie(e){var r=[];if(e!=null)for(var n in Object(e))r.push(n);return r}var Me=Object.prototype,Ee=Me.hasOwnProperty;function Ue(e){if(!F(e))return Ie(e);var r=q(e),n=[];for(var t in e)t=="constructor"&&(r||!Ee.call(e,t))||n.push(t);return n}function S(e){return ge(e)?he(e,!0):Ue(e)}var oe=de(Object.getPrototypeOf,Object);function _e(e,r){return e&&A(r,ee(r),e)}function Ce(e,r){return e&&A(r,S(r),e)}var se=typeof exports=="object"&&exports&&!exports.nodeType&&exports,D=se&&typeof module=="object"&&module&&!module.nodeType&&module,Ne=D&&D.exports===se,R=Ne?ye.Buffer:void 0,W=R?R.allocUnsafe:void 0;function Le(e,r){if(r)return e.slice();var n=e.length,t=W?W(n):new e.constructor(n);return e.copy(t),t}function Ge(e,r){return A(e,re(e),r)}var Be=Object.getOwnPropertySymbols,ae=Be?function(e){for(var r=[];e;)we(r,re(e)),e=oe(e);return r}:ze;function De(e,r){return A(e,ae(e),r)}function Re(e){return Ae(e,S,ae)}var We=Object.prototype,Ke=We.hasOwnProperty;function ke(e){var r=e.length,n=new e.constructor(r);return r&&typeof e[0]=="string"&&Ke.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function P(e){var r=new e.constructor(e.byteLength);return new L(r).set(new L(e)),r}function Ve(e,r){var n=r?P(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var He=/\w*$/;function Ye(e){var r=new e.constructor(e.source,He.exec(e));return r.lastIndex=e.lastIndex,r}var K=_?_.prototype:void 0,k=K?K.valueOf:void 0;function qe(e){return k?Object(k.call(e)):{}}function Je(e,r){var n=r?P(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var Xe="[object Boolean]",Ze="[object Date]",Qe="[object Map]",er="[object Number]",rr="[object RegExp]",nr="[object Set]",tr="[object String]",or="[object Symbol]",sr="[object ArrayBuffer]",ar="[object DataView]",lr="[object Float32Array]",ir="[object Float64Array]",cr="[object Int8Array]",ur="[object Int16Array]",fr="[object Int32Array]",pr="[object Uint8Array]",gr="[object Uint8ClampedArray]",dr="[object Uint16Array]",yr="[object Uint32Array]";function br(e,r,n){var t=e.constructor;switch(r){case sr:return P(e);case Xe:case Ze:return new t(+e);case ar:return Ve(e,n);case lr:case ir:case cr:case ur:case fr:case pr:case gr:case dr:case yr:return Je(e,n);case Qe:return new t;case er:case tr:return new t(e);case rr:return Ye(e);case nr:return new t;case or:return qe(e)}}function vr(e){return typeof e.constructor=="function"&&!q(e)?Oe(oe(e)):{}}var mr="[object Map]";function Tr(e){return J(e)&&O(e)==mr}var V=w&&w.isMap,hr=V?X(V):Tr,zr="[object Set]";function wr(e){return J(e)&&O(e)==zr}var H=w&&w.isSet,Ar=H?X(H):wr,xr=1,jr=2,Fr=4,le="[object Arguments]",Or="[object Array]",Sr="[object Boolean]",Pr="[object Date]",$r="[object Error]",ie="[object Function]",Ir="[object GeneratorFunction]",Mr="[object Map]",Er="[object Number]",ce="[object Object]",Ur="[object RegExp]",_r="[object Set]",Cr="[object String]",Nr="[object Symbol]",Lr="[object WeakMap]",Gr="[object ArrayBuffer]",Br="[object DataView]",Dr="[object Float32Array]",Rr="[object Float64Array]",Wr="[object Int8Array]",Kr="[object Int16Array]",kr="[object Int32Array]",Vr="[object Uint8Array]",Hr="[object Uint8ClampedArray]",Yr="[object Uint16Array]",qr="[object Uint32Array]",c={};c[le]=c[Or]=c[Gr]=c[Br]=c[Sr]=c[Pr]=c[Dr]=c[Rr]=c[Wr]=c[Kr]=c[kr]=c[Mr]=c[Er]=c[ce]=c[Ur]=c[_r]=c[Cr]=c[Nr]=c[Vr]=c[Hr]=c[Yr]=c[qr]=!0;c[$r]=c[ie]=c[Lr]=!1;function z(e,r,n,t,i,s){var a,o=r&xr,l=r&jr,u=r&Fr;if(a!==void 0)return a;if(!F(e))return e;var d=ve(e);if(d){if(a=ke(e),!o)return Fe(e,a)}else{var y=O(e),M=y==ie||y==Ir;if(be(e))return Le(e,o);if(y==ce||y==le||M&&!i){if(a=l||M?{}:vr(e),!o)return l?De(e,Ce(a,e)):Ge(e,_e(a,e))}else{if(!c[y])return i?e:{};a=br(e,y,o)}}s||(s=new xe);var E=s.get(e);if(E)return E;s.set(e,a),Ar(e)?e.forEach(function(b){a.add(z(b,r,n,b,e,s))}):hr(e)&&e.forEach(function(b,v){a.set(v,z(b,r,n,v,e,s))});var fe=u?l?Re:je:l?S:ee,U=d?void 0:fe(e);return Se(U||e,function(b,v){U&&(v=b,b=e[v]),te(a,v,z(b,r,n,v,e,s))}),a}var Jr=1,Xr=4;function Y(e){return z(e,Jr|Xr)}var f=(e=>(e.Fixed="fixed",e.Guess="guess",e))(f||{}),p=(e=>(e.Unknown="unknown",e.Wrong="wrong",e))(p||{}),m=(e=>(e.None="none",e.Pen="pen",e.Notes="notes",e))(m||{});function Zr(e){const r=Math.round(Math.pow(e.length,.25));if(r<3)return x(C(N.OUT_OF_RANGE,{message:"Field size is not supported",description:`Field size is empty or less then 9x9, current size: ${r}x${r}`}));if(r**4!==e.length)return x(C(N.OUT_OF_RANGE,{message:"Field size is invalid",description:`Field cell count must be a perfect square, current cells count: ${e.length}`}));try{const n=Array.from(e).map(i=>{const s=parseInt(i.replace(/[.\-*]/g,"0"),Math.max(10,r));return s===0?{type:f.Guess,value:void 0,notes:[],status:p.Unknown}:{type:f.Fixed,value:s,notes:[],status:p.Unknown}}),t=ue({size:r,cells:n});for(let i=0;i<t.size**2;i++)for(let s=0;s<t.size**2;s++){const a=g(i,s,t.size),o=t.cells[a];o.status===p.Wrong&&o.type===f.Fixed&&(o.type=f.Guess)}return T(t)}catch(n){return x(me(n))}}function hn(e){const r=[];for(let n=0;n<e;n++)for(let t=0;t<e;t++)r.push([n,t]);return r}function Qr(e,r,n,t){if(r.type===m.None)return e;const i=g(n,t,e.size),s=e.cells[i];if(s.type===f.Fixed)return e;const a=[...e.cells],o={...s};return r.type===m.Pen?o.value!==r.value?(o.value=r.value,o.notes=o.notes=o.notes.filter(l=>l!==r.value),$(e,n,t).forEach(({row:l,column:u,cell:d})=>{a[g(l,u,e.size)]={...d,notes:d.notes.filter(y=>y!==r.value)}})):o.value=void 0:r.type===m.Notes&&(o.value=void 0,o.notes.includes(r.value)?o.notes=o.notes.filter(l=>l!==r.value):o.notes.push(r.value)),a[i]=o,ue({...e,cells:a})}function g(e,r,n){return e*n**2+r}function $(e,r,n,t=["row","column","group"]){const i=new Map,s=Math.floor(r/e.size)*e.size,a=Math.floor(n/e.size)*e.size;for(let o=0;o<e.size**2;o++){if(t.includes("row")){const l=g(r,o,e.size);i.set(l,{row:r,column:o,cell:e.cells[l]})}if(t.includes("column")){const l=g(o,n,e.size);i.set(l,{row:o,column:n,cell:e.cells[l]})}if(t.includes("group")){const l=Math.floor(o/e.size),u=o%e.size,d=g(s+l,a+u,e.size);i.set(d,{row:s+l,column:a+u,cell:e.cells[d]})}}return Array.from(i.values())}function ue(e){const r=[...e.cells];for(let n=0;n<e.size**2;n++)for(let t=0;t<e.size**2;t++){const i=g(n,t,e.size),s=e.cells[i],a=!h(s.value)&&$(e,n,t).some(({row:o,column:l,cell:{value:u}})=>(o!==n||l!==t)&&u===s.value);r[i]={...s,status:a?p.Wrong:p.Unknown}}return{...e,cells:r}}function zn(e){const r=new Map;for(let n=0;n<e.size;n++)for(let t=0;t<e.size;t++){const i=new Set;for(let s=0;s<e.size;s++)for(let a=0;a<e.size;a++){const o=g(n*e.size+s,t*e.size+a,e.size),l=e.cells[o];h(l.value)||i.add(l.value)}i.forEach(s=>r.set(s,(r.get(s)??0)+1))}return r}function en(e){return Array(e).fill(0).map((r,n)=>n)}function rn(e){const r=[...e.cells];for(let n=0;n<e.size**2;n++)for(let t=0;t<e.size**2;t++){const i=g(n,t,e.size),s=e.cells[i],a=new Set($(e,n,t).filter(({row:o,column:l,cell:{value:u}})=>(o!==n||l!==t)&&!h(u)).map(({cell:{value:o}})=>o));r[i]={...s,notes:en(e.size**2).map(o=>o+1).filter(o=>!a.has(o))}}return{...e,cells:r}}function wn(e){for(let r=0;r<e.size**4;r++){const n=e.cells[r];if(n.status===p.Wrong||h(n.value))return!1}return!0}function nn(e){const r=[...e.cells];for(let n=0;n<e.size**4;n++){const t=e.cells[n];t.type===f.Fixed?r[n]={...t,status:p.Unknown}:r[n]={...t,notes:[],value:void 0,status:p.Unknown}}return{...e,cells:r}}function tn(e){for(let r=0;r<e.size**4;r++){const n=e.cells[r];if(n.type!==f.Fixed&&!Z(n.notes))return!0}return!1}function on(e){const r=[...e.cells];for(let n=0;n<e.size**4;n++){const t=e.cells[n];t.type===f.Fixed||Z(t.notes)||(r[n]={...t,notes:[]})}return{...e,cells:r}}const sn={field:Q,tool:{type:m.None,value:void 0},history:[]},I=Te({name:"sudoku",initialState:sn,reducers:e=>({resetPuzzle:e.reducer(r=>{r.field=Q,r.history=[]}),restartPuzzle:e.reducer(r=>{j(r.field)&&(r.field=T(nn(r.field.value)),r.history=[])}),loadPuzzle:e.reducer((r,{payload:n})=>{r.field=Zr(n),r.history=[]}),setTool:e.reducer((r,{payload:n})=>{if(!h(r.tool.value)&&r.tool.value===n.value&&r.tool.type===n.type){r.tool={type:m.None,value:void 0};return}r.tool=n}),applyTool:e.reducer((r,{payload:{row:n,column:t}})=>{if(!j(r.field)||r.field.value.size===0||r.tool.type===m.None)return;const i=r.field.value,s=Qr(r.field.value,r.tool,n,t);i!==s&&(r.history=[...r.history,Y(r.field.value)]),r.field=T(s)}),markField:e.reducer(r=>{!j(r.field)||r.field.value.size===0||(r.history=[...r.history,Y(r.field.value)],tn(r.field.value)?r.field=T(on(r.field.value)):r.field=T(rn(r.field.value)))}),restorePreviousState:e.reducer(r=>{const n=r.history.pop();h(n)||(r.field=T(n))})}),selectors:{selectField:({field:e})=>e,selectTool:({tool:e})=>e,selectHasHistory:({history:e})=>e.length>0}}),{resetPuzzle:an,restartPuzzle:ln,loadPuzzle:cn,setTool:un,applyTool:fn,markField:pn,restorePreviousState:gn}=I.actions,{selectField:dn,selectTool:yn,selectHasHistory:bn}=I.selectors,An=Object.freeze(Object.defineProperty({__proto__:null,applyTool:fn,loadPuzzle:cn,markField:pn,resetPuzzle:an,restartPuzzle:ln,restorePreviousState:gn,selectField:dn,selectHasHistory:bn,selectTool:yn,setTool:un,sudokuSlice:I},Symbol.toStringTag,{value:"Module"}));export{m as E,en as a,hn as b,f as c,p as d,yn as e,bn as f,zn as g,tn as h,fn as i,un as j,gn as k,cn as l,pn as m,ln as n,An as o,wn as p,an as r,dn as s};
