import{aj as F,am as pe,c1 as q,ak as ge,c2 as de,as as ye,ap as U,bV as Q,bS as S,c3 as w,ax as X,bT as be,aq as ve,i as h,Q as Z,Z as x,bK as C,bL as N,Y as T,$ as me,a0 as J,bX as Te,a9 as j}from"./e-CIfyzysY.js";import{b as he,k as ee,c as re,s as ze,a as we,d as Ae,U as L,S as xe,g as je}from"./c-D9ziwHmT.js";import{d as G,c as Fe}from"./c-CKMNIwHO.js";var B=Object.create,Se=function(){function e(){}return function(r){if(!F(r))return{};if(B)return B(r);e.prototype=r;var n=new e;return e.prototype=void 0,n}}();function Oe(e,r){for(var n=-1,t=e==null?0:e.length;++n<t&&r(e[n],n,e)!==!1;);return e}function ne(e,r,n){r=="__proto__"&&G?G(e,r,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[r]=n}var $e=Object.prototype,Pe=$e.hasOwnProperty;function te(e,r,n){var t=e[r];(!(Pe.call(e,r)&&pe(t,n))||n===void 0&&!(r in e))&&ne(e,r,n)}function A(e,r,n,t){var c=!n;n||(n={});for(var s=-1,a=r.length;++s<a;){var o=r[s],l=void 0;l===void 0&&(l=e[o]),c?ne(n,o,l):te(n,o,l)}return n}function Ie(e){var r=[];if(e!=null)for(var n in Object(e))r.push(n);return r}var Ee=Object.prototype,Me=Ee.hasOwnProperty;function _e(e){if(!F(e))return Ie(e);var r=q(e),n=[];for(var t in e)t=="constructor"&&(r||!Me.call(e,t))||n.push(t);return n}function O(e){return ge(e)?he(e,!0):_e(e)}var oe=de(Object.getPrototypeOf,Object);function Ue(e,r){return e&&A(r,ee(r),e)}function Ce(e,r){return e&&A(r,O(r),e)}var se=typeof exports=="object"&&exports&&!exports.nodeType&&exports,D=se&&typeof module=="object"&&module&&!module.nodeType&&module,Ne=D&&D.exports===se,R=Ne?ye.Buffer:void 0,K=R?R.allocUnsafe:void 0;function Le(e,r){if(r)return e.slice();var n=e.length,t=K?K(n):new e.constructor(n);return e.copy(t),t}function Ge(e,r){return A(e,re(e),r)}var Be=Object.getOwnPropertySymbols,ae=Be?function(e){for(var r=[];e;)we(r,re(e)),e=oe(e);return r}:ze;function De(e,r){return A(e,ae(e),r)}function Re(e){return Ae(e,O,ae)}var Ke=Object.prototype,ke=Ke.hasOwnProperty;function We(e){var r=e.length,n=new e.constructor(r);return r&&typeof e[0]=="string"&&ke.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function $(e){var r=new e.constructor(e.byteLength);return new L(r).set(new L(e)),r}function Ve(e,r){var n=r?$(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var He=/\w*$/;function Ye(e){var r=new e.constructor(e.source,He.exec(e));return r.lastIndex=e.lastIndex,r}var k=U?U.prototype:void 0,W=k?k.valueOf:void 0;function qe(e){return W?Object(W.call(e)):{}}function Qe(e,r){var n=r?$(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var Xe="[object Boolean]",Ze="[object Date]",Je="[object Map]",er="[object Number]",rr="[object RegExp]",nr="[object Set]",tr="[object String]",or="[object Symbol]",sr="[object ArrayBuffer]",ar="[object DataView]",lr="[object Float32Array]",cr="[object Float64Array]",ir="[object Int8Array]",ur="[object Int16Array]",fr="[object Int32Array]",pr="[object Uint8Array]",gr="[object Uint8ClampedArray]",dr="[object Uint16Array]",yr="[object Uint32Array]";function br(e,r,n){var t=e.constructor;switch(r){case sr:return $(e);case Xe:case Ze:return new t(+e);case ar:return Ve(e,n);case lr:case cr:case ir:case ur:case fr:case pr:case gr:case dr:case yr:return Qe(e,n);case Je:return new t;case er:case tr:return new t(e);case rr:return Ye(e);case nr:return new t;case or:return qe(e)}}function vr(e){return typeof e.constructor=="function"&&!q(e)?Se(oe(e)):{}}var mr="[object Map]";function Tr(e){return Q(e)&&S(e)==mr}var V=w&&w.isMap,hr=V?X(V):Tr,zr="[object Set]";function wr(e){return Q(e)&&S(e)==zr}var H=w&&w.isSet,Ar=H?X(H):wr,xr=1,jr=2,Fr=4,le="[object Arguments]",Sr="[object Array]",Or="[object Boolean]",$r="[object Date]",Pr="[object Error]",ce="[object Function]",Ir="[object GeneratorFunction]",Er="[object Map]",Mr="[object Number]",ie="[object Object]",_r="[object RegExp]",Ur="[object Set]",Cr="[object String]",Nr="[object Symbol]",Lr="[object WeakMap]",Gr="[object ArrayBuffer]",Br="[object DataView]",Dr="[object Float32Array]",Rr="[object Float64Array]",Kr="[object Int8Array]",kr="[object Int16Array]",Wr="[object Int32Array]",Vr="[object Uint8Array]",Hr="[object Uint8ClampedArray]",Yr="[object Uint16Array]",qr="[object Uint32Array]",i={};i[le]=i[Sr]=i[Gr]=i[Br]=i[Or]=i[$r]=i[Dr]=i[Rr]=i[Kr]=i[kr]=i[Wr]=i[Er]=i[Mr]=i[ie]=i[_r]=i[Ur]=i[Cr]=i[Nr]=i[Vr]=i[Hr]=i[Yr]=i[qr]=!0;i[Pr]=i[ce]=i[Lr]=!1;function z(e,r,n,t,c,s){var a,o=r&xr,l=r&jr,u=r&Fr;if(a!==void 0)return a;if(!F(e))return e;var d=ve(e);if(d){if(a=We(e),!o)return Fe(e,a)}else{var y=S(e),E=y==ce||y==Ir;if(be(e))return Le(e,o);if(y==ie||y==le||E&&!c){if(a=l||E?{}:vr(e),!o)return l?De(e,Ce(a,e)):Ge(e,Ue(a,e))}else{if(!i[y])return c?e:{};a=br(e,y,o)}}s||(s=new xe);var M=s.get(e);if(M)return M;s.set(e,a),Ar(e)?e.forEach(function(b){a.add(z(b,r,n,b,e,s))}):hr(e)&&e.forEach(function(b,v){a.set(v,z(b,r,n,v,e,s))});var fe=u?l?Re:je:l?O:ee,_=d?void 0:fe(e);return Oe(_||e,function(b,v){_&&(v=b,b=e[v]),te(a,v,z(b,r,n,v,e,s))}),a}var Qr=1,Xr=4;function Y(e){return z(e,Qr|Xr)}var f=(e=>(e.Fixed="fixed",e.Guess="guess",e))(f||{}),p=(e=>(e.Unknown="unknown",e.Wrong="wrong",e))(p||{}),m=(e=>(e.None="none",e.Pen="pen",e.Notes="notes",e))(m||{});function Zr(e){const r=Math.round(Math.pow(e.length,.25));if(r<3)return x(C(N.OUT_OF_RANGE,{message:"Field size is not supported",description:`Field size is empty or less then 9x9, current size: ${r}x${r}`}));if(r**4!==e.length)return x(C(N.OUT_OF_RANGE,{message:"Field size is invalid",description:`Field cell count must be a perfect square, current cells count: ${e.length}`}));try{const n=Array.from(e).map(c=>{const s=parseInt(c.replace(/[.\-*]/g,"0"),Math.max(10,r));return s===0?{type:f.Guess,value:void 0,notes:[],status:p.Unknown}:{type:f.Fixed,value:s,notes:[],status:p.Unknown}}),t=ue({size:r,cells:n});for(let c=0;c<t.size**2;c++)for(let s=0;s<t.size**2;s++){const a=g(c,s,t.size),o=t.cells[a];o.status===p.Wrong&&o.type===f.Fixed&&(o.type=f.Guess)}return T(t)}catch(n){return x(me(n))}}function hn(e){const r=[];for(let n=0;n<e;n++)for(let t=0;t<e;t++)r.push([n,t]);return r}function Jr(e,r,n,t){if(r.type===m.None)return e;const c=g(n,t,e.size),s=e.cells[c];if(s.type===f.Fixed)return e;const a=[...e.cells],o={...s};return r.type===m.Pen?o.value!==r.value?(o.value=r.value,o.notes=o.notes=o.notes.filter(l=>l!==r.value),P(e,n,t).forEach(({row:l,column:u,cell:d})=>{a[g(l,u,e.size)]={...d,notes:d.notes.filter(y=>y!==r.value)}})):o.value=void 0:r.type===m.Notes&&(o.value=void 0,o.notes.includes(r.value)?o.notes=o.notes.filter(l=>l!==r.value):o.notes.push(r.value)),a[c]=o,ue({...e,cells:a})}function g(e,r,n){return e*n**2+r}function P(e,r,n,t=["row","column","group"]){const c=new Map,s=Math.floor(r/e.size)*e.size,a=Math.floor(n/e.size)*e.size;for(let o=0;o<e.size**2;o++){if(t.includes("row")){const l=g(r,o,e.size);c.set(l,{row:r,column:o,cell:e.cells[l]})}if(t.includes("column")){const l=g(o,n,e.size);c.set(l,{row:o,column:n,cell:e.cells[l]})}if(t.includes("group")){const l=Math.floor(o/e.size),u=o%e.size,d=g(s+l,a+u,e.size);c.set(d,{row:s+l,column:a+u,cell:e.cells[d]})}}return Array.from(c.values())}function ue(e){const r=[...e.cells];for(let n=0;n<e.size**2;n++)for(let t=0;t<e.size**2;t++){const c=g(n,t,e.size),s=e.cells[c],a=!h(s.value)&&P(e,n,t).some(({row:o,column:l,cell:{value:u}})=>(o!==n||l!==t)&&u===s.value);r[c]={...s,status:a?p.Wrong:p.Unknown}}return{...e,cells:r}}function zn(e){const r=new Map;for(let n=0;n<e.size;n++)for(let t=0;t<e.size;t++){const c=new Set;for(let s=0;s<e.size;s++)for(let a=0;a<e.size;a++){const o=g(n*e.size+s,t*e.size+a,e.size),l=e.cells[o];h(l.value)||c.add(l.value)}c.forEach(s=>r.set(s,(r.get(s)??0)+1))}return r}function en(e){return Array(e).fill(0).map((r,n)=>n)}function rn(e){const r=[...e.cells];for(let n=0;n<e.size**2;n++)for(let t=0;t<e.size**2;t++){const c=g(n,t,e.size),s=e.cells[c],a=new Set(P(e,n,t).filter(({row:o,column:l,cell:{value:u}})=>(o!==n||l!==t)&&!h(u)).map(({cell:{value:o}})=>o));r[c]={...s,notes:en(e.size**2).map(o=>o+1).filter(o=>!a.has(o))}}return{...e,cells:r}}function wn(e){for(let r=0;r<e.size**4;r++){const n=e.cells[r];if(n.status===p.Wrong||h(n.value))return!1}return!0}function nn(e){const r=[...e.cells];for(let n=0;n<e.size**4;n++){const t=e.cells[n];t.type===f.Fixed?r[n]={...t,status:p.Unknown}:r[n]={...t,notes:[],value:void 0,status:p.Unknown}}return{...e,cells:r}}function tn(e){for(let r=0;r<e.size**4;r++){const n=e.cells[r];if(n.type!==f.Fixed&&!Z(n.notes))return!0}return!1}function on(e){const r=[...e.cells];for(let n=0;n<e.size**4;n++){const t=e.cells[n];t.type===f.Fixed||Z(t.notes)||(r[n]={...t,notes:[]})}return{...e,cells:r}}const sn={field:J,tool:{type:m.None,value:void 0},history:[]},I=Te({name:"sudoku",initialState:sn,reducers:e=>({resetPuzzle:e.reducer(r=>{r.field=J,r.history=[]}),restartPuzzle:e.reducer(r=>{j(r.field)&&(r.field=T(nn(r.field.value)),r.history=[])}),loadPuzzle:e.reducer((r,{payload:n})=>{r.field=Zr(n),r.history=[]}),setTool:e.reducer((r,{payload:n})=>{if(!h(r.tool.value)&&r.tool.value===n.value&&r.tool.type===n.type){r.tool={type:m.None,value:void 0};return}r.tool=n}),applyTool:e.reducer((r,{payload:{row:n,column:t}})=>{if(!j(r.field)||r.field.value.size===0||r.tool.type===m.None)return;const c=r.field.value,s=Jr(r.field.value,r.tool,n,t);c!==s&&(r.history=[...r.history,Y(r.field.value)]),r.field=T(s)}),markField:e.reducer(r=>{!j(r.field)||r.field.value.size===0||(r.history=[...r.history,Y(r.field.value)],tn(r.field.value)?r.field=T(on(r.field.value)):r.field=T(rn(r.field.value)))}),restorePreviousState:e.reducer(r=>{const n=r.history.pop();h(n)||(r.field=T(n))})}),selectors:{selectField:({field:e})=>e,selectTool:({tool:e})=>e,selectHasHistory:({history:e})=>e.length>0}}),{resetPuzzle:an,restartPuzzle:ln,loadPuzzle:cn,setTool:un,applyTool:fn,markField:pn,restorePreviousState:gn}=I.actions,{selectField:dn,selectTool:yn,selectHasHistory:bn}=I.selectors,An=Object.freeze(Object.defineProperty({__proto__:null,applyTool:fn,loadPuzzle:cn,markField:pn,resetPuzzle:an,restartPuzzle:ln,restorePreviousState:gn,selectField:dn,selectHasHistory:bn,selectTool:yn,setTool:un,sudokuSlice:I},Symbol.toStringTag,{value:"Module"}));export{m as E,en as a,hn as b,f as c,p as d,yn as e,bn as f,zn as g,tn as h,fn as i,un as j,gn as k,cn as l,pn as m,ln as n,An as o,wn as p,an as r,dn as s};
