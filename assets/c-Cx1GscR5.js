import{a5 as S,a8 as fe,bS as k,a6 as pe,bT as ge,ae as ye,ab as M,bK as J,bH as x,bU as A,aj as Q,bI as be,ac as de,i as T,G as j,bz as U,bA as C,F as h,H as ve,J as X,bL as me,W as N}from"./e-Ua95OQBm.js";import{b as Te,k as Z,c as ee,s as he,a as we,d as Ae,U as L,S as ze,g as je}from"./c-DRJdO70a.js";import{d as G,c as Se}from"./c-DHMU2-Tg.js";var B=Object.create,xe=function(){function e(){}return function(r){if(!S(r))return{};if(B)return B(r);e.prototype=r;var n=new e;return e.prototype=void 0,n}}();function Oe(e,r){for(var n=-1,t=e==null?0:e.length;++n<t&&r(e[n],n,e)!==!1;);return e}function re(e,r,n){r=="__proto__"&&G?G(e,r,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[r]=n}var Fe=Object.prototype,$e=Fe.hasOwnProperty;function ne(e,r,n){var t=e[r];(!($e.call(e,r)&&fe(t,n))||n===void 0&&!(r in e))&&re(e,r,n)}function z(e,r,n,t){var i=!n;n||(n={});for(var s=-1,a=r.length;++s<a;){var o=r[s],c=void 0;c===void 0&&(c=e[o]),i?re(n,o,c):ne(n,o,c)}return n}function Pe(e){var r=[];if(e!=null)for(var n in Object(e))r.push(n);return r}var Ie=Object.prototype,_e=Ie.hasOwnProperty;function Ee(e){if(!S(e))return Pe(e);var r=k(e),n=[];for(var t in e)t=="constructor"&&(r||!_e.call(e,t))||n.push(t);return n}function O(e){return pe(e)?Te(e,!0):Ee(e)}var te=ge(Object.getPrototypeOf,Object);function Me(e,r){return e&&z(r,Z(r),e)}function Ue(e,r){return e&&z(r,O(r),e)}var oe=typeof exports=="object"&&exports&&!exports.nodeType&&exports,D=oe&&typeof module=="object"&&module&&!module.nodeType&&module,Ce=D&&D.exports===oe,R=Ce?ye.Buffer:void 0,K=R?R.allocUnsafe:void 0;function Ne(e,r){if(r)return e.slice();var n=e.length,t=K?K(n):new e.constructor(n);return e.copy(t),t}function Le(e,r){return z(e,ee(e),r)}var Ge=Object.getOwnPropertySymbols,se=Ge?function(e){for(var r=[];e;)we(r,ee(e)),e=te(e);return r}:he;function Be(e,r){return z(e,se(e),r)}function De(e){return Ae(e,O,se)}var Re=Object.prototype,Ke=Re.hasOwnProperty;function We(e){var r=e.length,n=new e.constructor(r);return r&&typeof e[0]=="string"&&Ke.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function F(e){var r=new e.constructor(e.byteLength);return new L(r).set(new L(e)),r}function He(e,r){var n=r?F(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var Ve=/\w*$/;function Ye(e){var r=new e.constructor(e.source,Ve.exec(e));return r.lastIndex=e.lastIndex,r}var W=M?M.prototype:void 0,H=W?W.valueOf:void 0;function qe(e){return H?Object(H.call(e)):{}}function ke(e,r){var n=r?F(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var Je="[object Boolean]",Qe="[object Date]",Xe="[object Map]",Ze="[object Number]",er="[object RegExp]",rr="[object Set]",nr="[object String]",tr="[object Symbol]",or="[object ArrayBuffer]",sr="[object DataView]",ar="[object Float32Array]",cr="[object Float64Array]",ir="[object Int8Array]",ur="[object Int16Array]",lr="[object Int32Array]",fr="[object Uint8Array]",pr="[object Uint8ClampedArray]",gr="[object Uint16Array]",yr="[object Uint32Array]";function br(e,r,n){var t=e.constructor;switch(r){case or:return F(e);case Je:case Qe:return new t(+e);case sr:return He(e,n);case ar:case cr:case ir:case ur:case lr:case fr:case pr:case gr:case yr:return ke(e,n);case Xe:return new t;case Ze:case nr:return new t(e);case er:return Ye(e);case rr:return new t;case tr:return qe(e)}}function dr(e){return typeof e.constructor=="function"&&!k(e)?xe(te(e)):{}}var vr="[object Map]";function mr(e){return J(e)&&x(e)==vr}var V=A&&A.isMap,Tr=V?Q(V):mr,hr="[object Set]";function wr(e){return J(e)&&x(e)==hr}var Y=A&&A.isSet,Ar=Y?Q(Y):wr,zr=1,jr=2,Sr=4,ae="[object Arguments]",xr="[object Array]",Or="[object Boolean]",Fr="[object Date]",$r="[object Error]",ce="[object Function]",Pr="[object GeneratorFunction]",Ir="[object Map]",_r="[object Number]",ie="[object Object]",Er="[object RegExp]",Mr="[object Set]",Ur="[object String]",Cr="[object Symbol]",Nr="[object WeakMap]",Lr="[object ArrayBuffer]",Gr="[object DataView]",Br="[object Float32Array]",Dr="[object Float64Array]",Rr="[object Int8Array]",Kr="[object Int16Array]",Wr="[object Int32Array]",Hr="[object Uint8Array]",Vr="[object Uint8ClampedArray]",Yr="[object Uint16Array]",qr="[object Uint32Array]",u={};u[ae]=u[xr]=u[Lr]=u[Gr]=u[Or]=u[Fr]=u[Br]=u[Dr]=u[Rr]=u[Kr]=u[Wr]=u[Ir]=u[_r]=u[ie]=u[Er]=u[Mr]=u[Ur]=u[Cr]=u[Hr]=u[Vr]=u[Yr]=u[qr]=!0;u[$r]=u[ce]=u[Nr]=!1;function w(e,r,n,t,i,s){var a,o=r&zr,c=r&jr,l=r&Sr;if(a!==void 0)return a;if(!S(e))return e;var p=de(e);if(p){if(a=We(e),!o)return Se(e,a)}else{var g=x(e),I=g==ce||g==Pr;if(be(e))return Ne(e,o);if(g==ie||g==ae||I&&!i){if(a=c||I?{}:dr(e),!o)return c?Be(e,Ue(a,e)):Le(e,Me(a,e))}else{if(!u[g])return i?e:{};a=br(e,g,o)}}s||(s=new ze);var _=s.get(e);if(_)return _;s.set(e,a),Ar(e)?e.forEach(function(y){a.add(w(y,r,n,y,e,s))}):Tr(e)&&e.forEach(function(y,b){a.set(b,w(y,r,n,b,e,s))});var le=l?c?De:je:c?O:Z,E=p?void 0:le(e);return Oe(E||e,function(y,b){E&&(b=y,y=e[b]),ne(a,b,w(y,r,n,b,e,s))}),a}var kr=1,Jr=4;function q(e){return w(e,kr|Jr)}var m=(e=>(e.Fixed="fixed",e.Guess="guess",e))(m||{}),d=(e=>(e.Unknown="unknown",e.Wrong="wrong",e))(d||{}),v=(e=>(e.None="none",e.Pen="pen",e.Notes="notes",e))(v||{});function Qr(e){const r=Math.round(Math.pow(e.length,.25));if(r<3)return j(U(C.OUT_OF_RANGE,{message:"Field size is not supported",description:`Field size is empty or less then 9x9, current size: ${r}x${r}`}));if(r**4!==e.length)return j(U(C.OUT_OF_RANGE,{message:"Field size is invalid",description:`Field cell count must be a perfect square, current cells count: ${e.length}`}));try{const n=Array.from(e).map(i=>{const s=parseInt(i.replace(/[.\-*]/g,"0"),Math.max(10,r));return s===0?{type:m.Guess,value:void 0,notes:[],status:d.Unknown}:{type:m.Fixed,value:s,notes:[],status:d.Unknown}}),t=ue({size:r,cells:n});for(let i=0;i<t.size**2;i++)for(let s=0;s<t.size**2;s++){const a=f(i,s,t.size),o=t.cells[a];o.status===d.Wrong&&o.type===m.Fixed&&(o.type=m.Guess)}return h(t)}catch(n){return j(ve(n))}}function bn(e){const r=[];for(let n=0;n<e;n++)for(let t=0;t<e;t++)r.push([n,t]);return r}function Xr(e,r,n,t){if(r.type===v.None)return e;const i=f(n,t,e.size),s=e.cells[i];if(s.type===m.Fixed)return e;const a=[...e.cells],o={...s};return r.type===v.Pen?o.value!==r.value?(o.value=r.value,$(e,n,t).forEach(({row:c,column:l,cell:p})=>{a[f(c,l,e.size)]={...p,notes:p.notes.filter(g=>g!==r.value)}})):o.value=void 0:r.type===v.Notes&&(o.value=void 0,o.notes.includes(r.value)?o.notes=o.notes.filter(c=>c!==r.value):o.notes.push(r.value)),a[i]=o,ue({...e,cells:a})}function f(e,r,n){return e*n**2+r}function $(e,r,n,t=["row","column","group"]){const i=new Map,s=Math.floor(r/e.size)*e.size,a=Math.floor(n/e.size)*e.size;for(let o=0;o<e.size**2;o++){if(t.includes("row")){const c=f(r,o,e.size);i.set(c,{row:r,column:o,cell:e.cells[c]})}if(t.includes("column")){const c=f(o,n,e.size);i.set(c,{row:o,column:n,cell:e.cells[c]})}if(t.includes("group")){const c=Math.floor(o/e.size),l=o%e.size,p=f(s+c,a+l,e.size);i.set(p,{row:s+c,column:a+l,cell:e.cells[p]})}}return Array.from(i.values())}function ue(e){const r=[...e.cells];for(let n=0;n<e.size**2;n++)for(let t=0;t<e.size**2;t++){const i=f(n,t,e.size),s=e.cells[i],a=!T(s.value)&&$(e,n,t).some(({row:o,column:c,cell:{value:l}})=>(o!==n||c!==t)&&l===s.value);r[i]={...s,status:a?d.Wrong:d.Unknown}}return{...e,cells:r}}function dn(e){const r=new Map;for(let n=0;n<e.size;n++)for(let t=0;t<e.size;t++){const i=new Set;for(let s=0;s<e.size;s++)for(let a=0;a<e.size;a++){const o=f(n*e.size+s,t*e.size+a,e.size),c=e.cells[o];T(c.value)||i.add(c.value)}i.forEach(s=>r.set(s,(r.get(s)??0)+1))}return r}function Zr(e){return Array(e).fill(0).map((r,n)=>n)}function en(e){const r=[...e.cells];for(let n=0;n<e.size**2;n++)for(let t=0;t<e.size**2;t++){const i=f(n,t,e.size),s=e.cells[i],a=new Set($(e,n,t).filter(({row:o,column:c,cell:{value:l}})=>(o!==n||c!==t)&&!T(l)).map(({cell:{value:o}})=>o));r[i]={...s,notes:Zr(e.size**2).map(o=>o+1).filter(o=>!a.has(o))}}return{...e,cells:r}}function vn(e){for(let r=0;r<e.size**4;r++){const n=e.cells[r];if(n.status===d.Wrong||T(n.value))return!1}return!0}const rn={field:X,tool:{type:v.None,value:void 0},history:[]},P=me({name:"sudoku",initialState:rn,reducers:e=>({resetPuzzle:e.reducer(r=>{r.field=X,r.history=[]}),loadPuzzle:e.reducer((r,{payload:n})=>{r.field=Qr(n),r.history=[]}),setTool:e.reducer((r,{payload:n})=>{if(!T(r.tool.value)&&r.tool.value===n.value&&r.tool.type===n.type){r.tool={type:v.None,value:void 0};return}r.tool=n}),applyTool:e.reducer((r,{payload:{row:n,column:t}})=>{!N(r.field)||r.field.value.size===0||r.tool.type===v.None||(r.history=[...r.history,q(r.field.value)],r.field=h(Xr(r.field.value,r.tool,n,t)))}),markField:e.reducer(r=>{!N(r.field)||r.field.value.size===0||(r.history=[...r.history,q(r.field.value)],r.field=h(en(r.field.value)))}),restorePreviousState:e.reducer(r=>{const n=r.history.pop();T(n)||(r.field=h(n))})}),selectors:{selectField:({field:e})=>e,selectTool:({tool:e})=>e,selectHasHistory:({history:e})=>e.length>0}}),{resetPuzzle:nn,loadPuzzle:tn,setTool:on,applyTool:sn,markField:an,restorePreviousState:cn}=P.actions,{selectField:un,selectTool:ln,selectHasHistory:fn}=P.selectors,mn=Object.freeze(Object.defineProperty({__proto__:null,applyTool:sn,loadPuzzle:tn,markField:an,resetPuzzle:nn,restorePreviousState:cn,selectField:un,selectHasHistory:fn,selectTool:ln,setTool:on,sudokuSlice:P},Symbol.toStringTag,{value:"Module"}));export{v as E,Zr as a,bn as b,m as c,d,ln as e,fn as f,dn as g,sn as h,on as i,cn as j,mn as k,tn as l,an as m,vn as p,nn as r,un as s};
